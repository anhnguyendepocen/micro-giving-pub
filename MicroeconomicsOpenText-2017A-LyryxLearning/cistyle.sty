% % % % % % % % % % %
% Colours!!!
% % % % % % % % % % %
%

%Front Matter Colours
\definecolor{lyryxcolour}{HTML}{000033}
\definecolor{lyryxlogoy}{HTML}{E2970A}
\definecolor{lscshdrboxcolour}{HTML}{408DB0}
\definecolor{titlepageboxbg}{HTML}{5EA5C5}

%Sample text writing
\definecolor{sampletextcolour}{HTML}{B18B45}

% Title page colours
\definecolor{titlepagecolour}{HTML}{408DB0}
\definecolor{titletextcolour}{HTML}{FAA21A}
\definecolor{subtitletextcolour}{HTML}{FEE8C6}
\definecolor{otctextcolour}{HTML}{BFD9E5}
\definecolor{cctextcolour}{HTML}{006795}
\definecolor{solutiontextcolour}{HTML}{FAA21A}

% LSCS page text colour
\definecolor{lscstextcolour}{HTML}{FAA21A} %match title text colour

% Colour for grey square in page headers
\definecolor{headersquarecolour}{HTML}{BDBDBD}

% Section and subsection header colours
\definecolor{sectionheadercolour}{HTML}{FAA21A}
\definecolor{subsectionheadercolour}{HTML}{FAA21A}

% Links and urls colour
\definecolor{linkcolour}{HTML}{003E59}

% Terminology colour
\definecolor{terminologycolour}{HTML}{006795}

% Table row colour
\definecolor{rowcolour}{HTML}{E6F0F5}

% Part page colours
\definecolor{parttextcolour}{HTML}{006795}
\definecolor{partlinecolour}{HTML}{FAA21A}

% Chapter header colours
\definecolor{mainchapterboxcolour}{HTML}{FEE8C6}
\definecolor{chapternameboxcolour}{HTML}{006795}
\definecolor{chaptertextcolour}{HTML}{FAA21A}

% % % % % % % % % % %
% Colours for boxes (Chapter, Highlight, Definition, Key terms, Application boxes) and box shadow colour
% % % % % % % % % % %
%
% Chapter topics box colours
\definecolor{chaptopicsoutlinecolour}{HTML}{FAA21A}
\definecolor{chaptopicsbkgdcolour}{HTML}{FEE8C6}

% Highlight box colours
\definecolor{highlightoutlinecolour}{HTML}{408DB0}
\definecolor{highlightbkgdcolour}{HTML}{80B3CA}

% Definition box colours
\definecolor{deffontcolour}{HTML}{006795}
\definecolor{deflinecolour}{HTML}{006795}
\definecolor{defbkgdcolour}{HTML}{FAFAFA}

% Key terms box colours
\definecolor{keytermslinecolour}{HTML}{006795}
\definecolor{keytermsbkgdcolour}{HTML}{FAFAFA}

% Application box colours
\definecolor{applinecolour}{HTML}{80B3CA}
\definecolor{appbkgdcolour}{HTML}{E6F0F5}

% Box shadow colour
\definecolor{boxshadowcolour}{HTML}{D8D8D8}
%
% % % % % % % % % % %

% % % % % % % % % % %
% Colours for figures and functions
% % % % % % % % % % %
%
% Tikz figure background colour
\definecolor{figurebkgdcolour}{HTML}{FAFAFA}

% Pie chart colours
\definecolor{piecolourone}{HTML}{CAA496}
\definecolor{piecolourtwo}{HTML}{DDE9EC}
\definecolor{piecolourthree}{HTML}{C4C4CE}
\definecolor{piecolourfour}{HTML}{A9AFC7}
\definecolor{piecolourfive}{HTML}{9FB8CD}
\definecolor{piecoloursix}{HTML}{DBE296}
\definecolor{piecolourseven}{HTML}{FBE093}

% PPF function colours
\definecolor{ppfcolourone}{HTML}{006795}
\definecolor{ppfcolourtwo}{HTML}{FAA21A}
\definecolor{ppfcolourthree}{HTML}{800080}
\definecolor{ppfcolourfour}{HTML}{E64B00}

% dataset line colours
\definecolor{datasetcolourone}{HTML}{FAA21A}
\definecolor{datasetcolourtwo}{HTML}{006795}
\definecolor{datasetcolourthree}{HTML}{800080}
\definecolor{datasetcolourfour}{HTML}{E64B00}

% Price-mortgage relationship colour
\definecolor{pricemortcolour}{HTML}{800080}

% Regression line colour
\definecolor{reglinecolour}{HTML}{800080}

% Supply and demand function colours
\definecolor{supplycolour}{HTML}{FAA21A}
\definecolor{demandcolour}{HTML}{006795}

% Industry demand (used in ch12fig2)
\definecolor{inddemandcolour}{HTML}{55198E}

% Market supply (used in ch9fig3)
\definecolor{marketsupplycolour}{HTML}{FAA21A}

% Total utility
\definecolor{tucolour}{HTML}{800080}

% Marginal utility
\definecolor{mucolour}{HTML}{C4C4CE}

% Budget line (constraint)
\definecolor{budgetcolour}{HTML}{000000}

% Indifference curve
\definecolor{indiffcolour}{HTML}{800080}

% Total product curve (TP)
\definecolor{tpcolour}{HTML}{800080}

% Average product curve (AP)
\definecolor{apcolour}{HTML}{000000}

% Marginal product curve (MP)
\definecolor{mpcolour}{HTML}{E64B00}

% Total cost curve (TC)
\definecolor{tccolour}{HTML}{E64B00}

% Variable cost curve (VC)
\definecolor{vccolour}{HTML}{EE814D}

% Fixed cost curve (FC)
\definecolor{fccolour}{HTML}{000000}

% Marginal cost curve (MC)
\definecolor{mccolour}{HTML}{E64B00}

% Average Total cost (ATC) [also Average cost (AC)?]
\definecolor{atccolour}{HTML}{E64B00}

% Average variable cost (AVC)
\definecolor{avccolour}{HTML}{FAA21A}

% Average fixed cost (AFC)
\definecolor{afccolour}{HTML}{800080}

% Long-run marginal cost (LMC)
\definecolor{lmccolour}{HTML}{E64B00}

% Total revenue (TR)
\definecolor{trcolour}{HTML}{000000}

% Marginal revenue (MR)
\definecolor{mrcolour}{HTML}{006795}

% Short-run average cost (SAC)
\definecolor{saccolour}{HTML}{E64B00}

% Long-run average total cost (LATC) [also LAC?]
\definecolor{latccolour}{HTML}{E64B00}

% Value of marginal product (VMP)
\definecolor{vmpcolour}{HTML}{800080}
%
% % % % % % % % % % %
% End of Colours!!!
% % % % % % % % % % %


%%%%%%
% new commands used in section and page header format
\newcommand\graysquare{\textcolor{headersquarecolour}{\rule{1ex}{1ex}}}

\pagestyle{fancy}
\renewcommand{\chaptermark}[1]{\markboth{#1}{}}
\renewcommand{\sectionmark}[1]{\markright{\thesection.\ #1}}
\fancyhf{}
\fancyhead[RO]{\rightmark\hspace{0.5em}\graysquare\hspace{0.5em}\thepage}
\fancyhead[LE]{\thepage\hspace{0.5em}\graysquare\hspace{0.5em}\leftmark}
\renewcommand{\headrulewidth}{0pt}

%% Change name from 'Contents' to 'Table of Contents'
\AtBeginDocument{\renewcommand\contentsname{Table of Contents}}


%% Unnumbered chapter header formatting (in particular, it removes the "Chapter 0" from ToC)
\titleformat{name=\chapter,numberless}[display]{}{}{0pt}{
	\tikz[overlay,remember picture]
	\fill[mainchapterboxcolour]
	([yshift=-1cm,xshift=1.75cm]current page.north west) rectangle 
	([yshift=-3.5cm,xshift=-1cm] current page.north east);
	\begin{tikzpicture}[overlay,remember picture]
	\node[rectangle,fill=chapternameboxcolour,text=white,font=\Large\bfseries,inner ysep=12pt,inner xsep=20pt,anchor=east,xshift=-20mm,yshift=-35mm] 
	at (current page.north east) {#1};
	\end{tikzpicture}
}
[
	\addcontentsline{toc}{part}{#1}
	\setcounter{section}{0}
	\markboth{#1}{#1}
]
\titlespacing*{\chapter}{0pt}{0pt}{10mm}

%% Chapter header formatting
\titleformat{\chapter}{}{}{0pt}{
	\tikz[overlay,remember picture]
	\fill[mainchapterboxcolour]
	([yshift=-1cm,xshift=1.75cm]current page.north west) rectangle 
	([yshift=-3.5cm,xshift=-1cm] current page.north east);
	\begin{tikzpicture}[overlay,remember picture]
	\node[anchor=south west,xshift=20mm,yshift=-28mm,font=\sffamily\bfseries\Huge,text=chaptertextcolour] 
	at (current page.north west) 
	{\chaptername\ \thechapter};
	\node[rectangle,fill=chapternameboxcolour,text=white,font=\Large\bfseries,inner ysep=12pt,inner xsep=20pt,anchor=east,xshift=-20mm,yshift=-35mm] 
	at (current page.north east) {#1};
	\end{tikzpicture}
}
\titlespacing*{\chapter}{0pt}{0pt}{10mm}


% Color section headings
\titleformat{\section}
{
	\hypersetup{linkcolor=sectionheadercolour}
	\Large\bfseries\color{sectionheadercolour}
}
{\thesection}{1em}{\phantomsection #1}
[
	\hypersetup{linkcolor=linkcolour}
]

% Unnumbered sections
\titleformat{name=\section,numberless}
{
	\hypersetup{linkcolor=sectionheadercolour}
	\Large\bfseries\color{sectionheadercolour}
}{}{0pt}{\phantomsection \textsc{#1}}
[
	\hypersetup{linkcolor=linkcolour}
	\markboth{#1}{#1}
]


% Color subsection headings
\titleformat{\subsection}{\large\bfseries\color{subsectionheadercolour}}{\thesubsection}{0pt}{#1}


%%%%%%
% Semantic information
\newcommand{\terminology}[1]{\textcolor{terminologycolour}{\textbf{#1}}}


%%%%%%
% Chapter topics box
\newenvironment{topics}[0]
{
\begin{mdframed}[style=topicsframe]
}
{
\end{mdframed}
}

\global\mdfdefinestyle{topicsframe}{userdefinedwidth=22em,linecolor=chaptopicsoutlinecolour,linewidth=2pt,backgroundcolor=chaptopicsbkgdcolour,shadow=true,shadowsize=8pt,shadowcolor=boxshadowcolour,innertopmargin=15pt,innerbottommargin=15pt,innerleftmargin=15pt,innerrightmargin=15pt,roundcorner=5pt}



%%%%%%
% Highlight  box (for lscs)
\newenvironment{highlight}[0]
{
\begin{mdframed}[style=highlightframe]
}
{
\end{mdframed}
}

\global\mdfdefinestyle{highlightframe}{linecolor=highlightoutlinecolour,linewidth=0pt,backgroundcolor=highlightbkgdcolour,shadow=false,shadowsize=4pt,shadowcolor=boxshadowcolour,innertopmargin=3pt,innerbottommargin=2pt,innerleftmargin=2pt,innerrightmargin=2pt,roundcorner=5pt}



%%%%%%
% Definition box
\newenvironment{DefBox}[0]
{
\begin{mdframed}[style=definitionframe]
}
{
\end{mdframed}
}

\global\mdfdefinestyle{definitionframe}{fontcolor=deffontcolour,linecolor=deflinecolour,linewidth=1.5pt,backgroundcolor=defbkgdcolour,topline=false,bottomline=false,rightline=false,innertopmargin=2pt,innerbottommargin=2pt,innerleftmargin=2pt,innerrightmargin=2pt}


%%%%%%
% Box for Key Terms
\newenvironment{keyterms}[0]
{
\begin{mdframed}[style=keytermsframe]
}
{
\end{mdframed}
}

\global\mdfdefinestyle{keytermsframe}{linecolor=keytermslinecolour,linewidth=1.5pt,backgroundcolor=keytermsbkgdcolour,innertopmargin=10pt,innerbottommargin=10pt,innerleftmargin=10pt,innerrightmargin=10pt,roundcorner=5pt,splittopskip=2\topsep,splitbottomskip=2\topsep,everyline=true}


%%%%%%
% Application Box
\DeclareFloatingEnvironment[
  fileext=los,
  listname=Application Box,
  name=Application Box,
  placement=tbhp,
  within=chapter,
]{application}

\newenvironment{applicationbox}[0]
{
\begin{mdframed}[style=applicationboxframe]\itshape
}
{
\end{mdframed}
}

\global\mdfdefinestyle{applicationboxframe}{fontcolor=black,linecolor=applinecolour,linewidth=1pt,backgroundcolor=appbkgdcolour,shadow=true,shadowsize=8pt,shadowcolor=boxshadowcolour,innertopmargin=12pt,innerbottommargin=12pt,innerleftmargin=12pt,innerrightmargin=12pt,roundcorner=5pt}

\NewDocumentEnvironment{ApplicationBox}{m}
{
\begin{application}[H]
\begin{applicationbox}
}
{
\end{applicationbox}
\caption{#1}
\end{application}
}


%%%%%%
% Style of hyperlinks to sections in text and urls
\hypersetup{
        pdfborder=0 0 0,
        colorlinks=true,
        allcolors=linkcolour, % Default color
        linkcolor=linkcolour, % Chapter/Section links, figures, tables, etc
        urlcolor=linkcolour, % other urls
}



%%%%%%
% Table environment (used only for tables with sub captions)
\NewDocumentEnvironment{Table}{mmm}
{
	\begin{table}[H]
		\begin{center}
		}
		{
		\end{center}
			\caption{#2}
			\captionsetup{singlelinecheck=off,font=footnotesize,width=#1}
			\caption*{#3}
	\end{table}
}
%
%%%%%%



%%%%%%
% Tikz figure box
\NewDocumentEnvironment{FigureBox}{mmmmm}
{
\begin{figure}[H]
\begin{center}
\begin{tikzpicture}[background color=figurebkgdcolour,use background,xscale=#1,yscale=#2]
}
{
\end{tikzpicture}
\caption{#4}
\captionsetup{singlelinecheck=off,font=footnotesize,width=#3}
\caption*{#5}
\end{center}
\end{figure}
}

% % % % % % % % % % % % %
% Define special Tikz environments
% % % % % % % % % % % % %
% Tikz node with \scriptsize (very small) text, left aligned
\tikzset{
	mynode/.style={
		font=\scriptsize,
		align=left,
		execute at begin node=\setlength{\baselineskip}{-1em} 	% reduces space between lines of text
	}
}

% Tikz node with regular sized text, left aligned
\tikzset{
	mynode1/.style={
		align=left,
		execute at begin node=\setlength{\baselineskip}{-1em} 	% reduces space between lines of text
	}
}


% Key to change background color in Tikz and pgfplot
\pgfkeys{/tikz/.cd,
  background color/.initial=graphicbackground,
  background color/.get=\backcol,
  background color/.store in=\backcol,
}
\tikzset{background rectangle/.style={
    fill=\backcol,
  },
  use background/.style={    
    show background rectangle
  }
}



%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% For the pie charts
\tikzstyle{chart}=[
    legend label/.style={font={\scriptsize},anchor=west,align=left},
    legend box/.style={rectangle, draw, minimum size=5pt},
    axis/.style={black,semithick,->},
    axis label/.style={anchor=east,font={\tiny}},
]

\tikzstyle{pie chart}=[
    chart,
    slice/.style={line cap=round, line join=round, very thick,draw=white},
    pie title/.style={font={\bf}},
    slice type/.style 2 args={
        ##1/.style={fill=##2},
        values of ##1/.style={}
    }
]

\pgfdeclarelayer{background}
\pgfdeclarelayer{foreground}
\pgfsetlayers{background,main,foreground}


\newcommand{\pie}[2][]{
    \begin{scope}[#1]
    \pgfmathsetmacro{\curA}{90}
    \pgfmathsetmacro{\r}{1}
    \def\c{(0,0)};
    \foreach \v/\s in{#2}{
        \pgfmathsetmacro{\deltaA}{\v/100*360}
        \pgfmathsetmacro{\nextA}{\curA + \deltaA}
        \pgfmathsetmacro{\midA}{(\curA+\nextA)/2}

        \path[slice,\s] \c
            -- +(\curA:\r)
            arc (\curA:\nextA:\r)
            -- cycle;
        \pgfmathsetmacro{\d}{max((\deltaA * -(.5/50) + 1) , .5)}

        \begin{pgfonlayer}{foreground}
        \path \c -- node[pos=\d,pie values,values of \s]{$\v\%$} +(\midA:\r);
        \end{pgfonlayer}

        \global\let\curA\nextA
    }
    \end{scope}
}

\newcommand{\legend}[2][]{
    \begin{scope}[#1]
    \path
        \foreach \n/\s in {#2}
            {
                  ++(0,-10pt) node[\s,legend box] {} +(5pt,0) node[legend label] {\n}
            }
    ;
    \end{scope}
}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%




% Convenient way to place a hidden coordinate anywhere in the text, which can be referenced
% in tikz drawing commands later.
\newcommand{\tikzcoordinate}[1]{\tikz[remember picture]{
   \node[coordinate] (#1) {};
}}


% % % % % % % % % %
% Redefining enumerate styles for only part of the book
% Changes all first level items in listed to (a),(b),(c),etc
\newenvironment{enumialphparenastyle}{
	\let\oldlabelenumi=\labelenumi
	\renewcommand{\labelenumi}{\textrm{(\alph{enumi})}}
}{
\let\labelenumi=\oldlabelenumi
\setcounter{ex}{0}
}
%
% % % % % % % % % %


% % % % % % % % % %
% Table style adjustments
% % % % % % % % % %
%
% Increase height of rows in tables
\global\extrarowsep=1mm

% increase border width in tables
\tabulinestyle{1.2pt}
%
% % % % % % % % % %


% % % % % % % % % %
% Exercises and solutions
% % % % % % % % % %
%
% Counter for exercises
\newcounter{ex}[chapter]
\renewcommand{\theex}{\thechapter.\arabic{ex}}

% ex env
% can \def\myeconextitle{#1} if we want to save the title for use in the solution
\newenvironment{ex}{
	\par\medskip\noindent\refstepcounter{ex}\textbf{Exercise \theex}
}{
\par\medskip
}

% answers package will place solutions in an econsolout env
\newenvironment{solout}[1]{
	\par\medskip\noindent\textbf{Exercise #1}\par
}{
\par\medskip
}
% answers package uses this command to copy params from exercise environment to solout
\newcommand{\soloutparams}{{\theex}}

% exsolution env, where output is sent to exsolutions file and text placed in exsolout envs
\Newassociation{sol}{Answer}{solutions}
%
% % % % % % % % % %

%%changes for new title page:

% A hack to do something like the center environment, but without spaces around it
\newenvironment{center*}[0]{\bgroup \centering}
{
	
	\egroup
}

%%Cover page box 
% For the main box containing 'Lyryx with Open Texts' and four images
\newtcolorbox{titlemainbox}{colback=titlepageboxbg,colframe=titlepageboxbg,before={\par\bigskip\pagebreak[0]\parindent=0pt},after={\par\bigskip},top=0em,bottom=1em, width=6in}

% % % % % % % % % %
% Boxes on title page (not currently used)
\newenvironment{titlepagebox}[0]
{
	\mdframed[style=titlepageboxstyle]
}{
\endmdframed
}
%
% TODO: Figure out why the innertopmargin & innerbottommargin have to be different between the marketing versions (or text and print cover) versus the regular (pdf) versions.
\global\mdfdefinestyle{titlepageboxstyle}{linewidth=0pt,backgroundcolor=titlepageboxbg,linecolor=titlepageboxbg,innertopmargin=1mm,innerbottommargin=11mm,skipabove=2mm,skipbelow=2mm,roundcorner=5pt}
%
% % % % % % % % % %

% % % % % % % % % %
% Highlight  box (for lscs)
\newenvironment{lscshdrbox}[0]
{
	\mdframed[style=lscsheaderframe]
	\bf
}
{
	\endmdframed
}

\global\mdfdefinestyle{lscsheaderframe}{linecolor=lscshdrboxcolour,linewidth=0pt,fontcolor=white,backgroundcolor=lscshdrboxcolour,shadow=false,innertopmargin=3pt,innerbottommargin=3pt,innerleftmargin=8pt,innerrightmargin=2pt,roundcorner=5pt,skipabove=4mm,skipbelow=3mm,frametitleaboveskip=\baselineskip, userdefinedwidth=17.5em}
%
% % % % % % % % % %



% Font used in componentnode
\newcommand*{\cmpfont}{\robotocondensed\selectfont}

% Font used for Logo type 
\newcommand*{\logofont}{\robotocondensed\selectfont}

\tikzset{
	componentnode/.style={
		font=\scriptsize\cmpfont,
		align=center,
		white,
		execute at begin node=\setlength{\baselineskip}{1.25em} 	% increases space between lines of text
	}
}


% % % % % % % % % %
% Creates page on left side
\newcommand*\cleartoleftpage{%
	\clearpage
	\ifodd\value{page}\hbox{}\newpage\fi
}
